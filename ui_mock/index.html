<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„É°„É≥„Éê„Éº‰∏ÄË¶ß - SET LIST</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: #333;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
            text-align: left;
        }

        .info-item {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .info-item strong {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
        }

        .nav-btn {
            background: #555;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .nav-btn:hover {
            background: #666;
        }

        .nav-btn.active {
            background: #333;
        }

        .pdf-btn {
            background: #666;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .pdf-btn:hover {
            background: #777;
        }

        .pdf-btn::before {
            content: "üìÑ";
            font-size: 1.2rem;
        }

        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #333;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        tr:hover {
            background-color: #f0f0f0;
        }

        .number {
            font-weight: bold;
            color: #333;
            text-align: center;
            width: 60px;
        }

        .name {
            font-weight: 600;
            color: #333;
        }

        .part {
            color: #555;
        }

        .contact {
            color: #666;
            font-size: 0.9rem;
        }

        .representative {
            text-align: center;
            width: 60px;
        }

        .dash-radio {
            display: none;
        }

        .dash-label {
            display: inline-block;
            width: 25px;
            height: 25px;
            border: 2px solid #333;
            border-radius: 3px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            text-align: center;
            line-height: 19px;
            font-weight: bold;
            font-size: 16px;
        }

        .dash-radio:checked + .dash-label {
            background: #333;
            color: white;
        }

        .dash-label:hover {
            border-color: #666;
            background: #f0f0f0;
        }

        .dash-radio:checked + .dash-label:hover {
            background: #333;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 0 15px;
        }

        .table-header h3 {
            color: #333;
            margin: 0;
        }

        .add-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .add-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }

        .add-icon {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .actions {
            text-align: center;
            width: 80px;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            background: #c82333;
        }

        .submit-btn {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .submit-btn:hover {
            background: linear-gradient(135deg, #0056b3 0%, #004085 100%);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .submit-btn::before {
            content: "üîó";
            font-size: 1.2rem;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px 30px;
            text-align: center;
            color: #666;
            border-top: 1px solid #eee;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .header-info {
                grid-template-columns: 1fr;
            }
            
            .nav-buttons {
                flex-direction: column;
            }
            
            .pdf-btn {
                margin-left: 0;
                margin-top: 10px;
            }
            
            th, td {
                padding: 10px 8px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>„É°„É≥„Éê„Éº‰∏ÄË¶ß</h1>
            <div class="header-info">
                <div class="info-item">
                    <strong>„Éê„É≥„ÉâÂêç</strong>
                    „Çª„ÉÉ„Éà„É™„Çπ„Éà„É°„Éº„Ç´„Éº
                </div>
                <div class="info-item">
                    <strong>„É°„É≥„Éê„ÉºÊï∞</strong>
                    7‰∫∫
                </div>
                <div class="info-item">
                    <strong>ÂÖ¨ÊºîÊó•</strong>
                    2022Âπ¥08Êúà17Êó•
                </div>
                <div class="info-item">
                    <strong>ÊºîÂ•èÊôÇÈñì</strong>
                    <span id="totalTime">Ë®àÁÆó‰∏≠...</span>
                </div>
            </div>
        </div>

        <div class="content">
            <div class="nav-buttons">
                <a href="index.html" class="nav-btn active">„É°„É≥„Éê„Éº‰∏ÄË¶ß</a>
                <a href="set_list.html" class="nav-btn">„Çª„ÉÉ„Éà„É™„Çπ„Éà</a>
                <a href="requests.html" class="nav-btn">Èü≥Èüø„ÉªÁÖßÊòéË¶ÅÊúõ</a>
                <button class="pdf-btn" onclick="generatePDF()">PDFÂá∫Âäõ</button>
                <button class="submit-btn" onclick="createSubmitURL()">ÊèêÂá∫Áî®URL‰ΩúÊàê</button>
            </div>

            <div class="table-container">
                <div class="table-header">
                    <h3>„É°„É≥„Éê„Éº‰∏ÄË¶ß</h3>
                    <button class="add-btn" onclick="addMember()">
                        <span class="add-icon">+</span>
                        „É°„É≥„Éê„ÉºËøΩÂä†
                    </button>
                </div>
                <table id="memberTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>‰ª£Ë°®ËÄÖ</th>
                            <th>Ê∞èÂêç</th>
                            <th>„Éë„Éº„Éà</th>
                            <th>ÈÄ£Áµ°ÂÖà</th>
                            <th>Êìç‰Ωú</th>
                        </tr>
                    </thead>
                    <tbody id="memberTableBody">
                        <tr>
                            <td class="number">‚ë†</td>
                            <td class="representative">
                                <input type="radio" name="representative" id="dash1" value="1" class="dash-radio">
                                <label for="dash1" class="dash-label"></label>
                            </td>
                            <td class="name">Áî∞‰∏≠Â§™ÈÉé</td>
                            <td class="part">„Éú„Éº„Ç´„É´</td>
                            <td class="contact">090-1234-5678</td>
                            <td class="actions">
                                <button class="delete-btn" onclick="deleteMember(this)">ÂâäÈô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td class="number">‚ë°</td>
                            <td class="representative">
                                <input type="radio" name="representative" id="dash2" value="2" class="dash-radio">
                                <label for="dash2" class="dash-label"></label>
                            </td>
                            <td class="name">‰ΩêËó§Ëä±Â≠ê</td>
                            <td class="part">„ÇÆ„Çø„Éº</td>
                            <td class="contact">090-2345-6789</td>
                            <td class="actions">
                                <button class="delete-btn" onclick="deleteMember(this)">ÂâäÈô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td class="number">‚ë¢</td>
                            <td class="representative">
                                <input type="radio" name="representative" id="dash3" value="3" class="dash-radio">
                                <label for="dash3" class="dash-label"></label>
                            </td>
                            <td class="name">Èà¥Êú®‰∏ÄÈÉé</td>
                            <td class="part">„Éô„Éº„Çπ</td>
                            <td class="contact">090-3456-7890</td>
                            <td class="actions">
                                <button class="delete-btn" onclick="deleteMember(this)">ÂâäÈô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td class="number">‚ë£</td>
                            <td class="representative">
                                <input type="radio" name="representative" id="dash4" value="4" class="dash-radio">
                                <label for="dash4" class="dash-label"></label>
                            </td>
                            <td class="name">È´òÊ©ãÁæéÂí≤</td>
                            <td class="part">„Éâ„É©„É†</td>
                            <td class="contact">090-4567-8901</td>
                            <td class="actions">
                                <button class="delete-btn" onclick="deleteMember(this)">ÂâäÈô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td class="number">‚ë§</td>
                            <td class="representative">
                                <input type="radio" name="representative" id="dash5" value="5" class="dash-radio">
                                <label for="dash5" class="dash-label"></label>
                            </td>
                            <td class="name">‰ºäËó§ÂÅ•Â§™</td>
                            <td class="part">„Ç≠„Éº„Éú„Éº„Éâ</td>
                            <td class="contact">090-5678-9012</td>
                            <td class="actions">
                                <button class="delete-btn" onclick="deleteMember(this)">ÂâäÈô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td class="number">‚ë•</td>
                            <td class="representative">
                                <input type="radio" name="representative" id="dash6" value="6" class="dash-radio">
                                <label for="dash6" class="dash-label"></label>
                            </td>
                            <td class="name">Ê∏°Ëæ∫ÊÑõ</td>
                            <td class="part">„Çµ„ÉÉ„ÇØ„Çπ</td>
                            <td class="contact">090-6789-0123</td>
                            <td class="actions">
                                <button class="delete-btn" onclick="deleteMember(this)">ÂâäÈô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td class="number">‚ë¶</td>
                            <td class="representative">
                                <input type="radio" name="representative" id="dash7" value="7" class="dash-radio">
                                <label for="dash7" class="dash-label"></label>
                            </td>
                            <td class="name">Â±±Áî∞Ê¨°ÈÉé</td>
                            <td class="part">„Éà„É©„É≥„Éö„ÉÉ„Éà</td>
                            <td class="contact">090-7890-1234</td>
                            <td class="actions">
                                <button class="delete-btn" onclick="deleteMember(this)">ÂâäÈô§</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer">
            This form is created by <a href="https://mosquit.one" target="_blank" style="color: #007bff; text-decoration: none;">mosquit.one</a>
        </div>
    </div>

    <!-- jsPDF „É©„Ç§„Éñ„É©„É™ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script>
        let memberCount = 7; // ÁèæÂú®„ÅÆ„É°„É≥„Éê„ÉºÊï∞

        function addMember() {
            memberCount++;
            const tbody = document.getElementById('memberTableBody');
            const newRow = document.createElement('tr');
            
            // Áï™Âè∑„ÅÆÊñáÂ≠óÂ§âÊèõ
            const numberText = convertToJapaneseNumber(memberCount);
            
            newRow.innerHTML = `
                <td class="number">${numberText}</td>
                <td class="representative">
                    <input type="radio" name="representative" id="dash${memberCount}" value="${memberCount}" class="dash-radio">
                    <label for="dash${memberCount}" class="dash-label"></label>
                </td>
                <td class="name" contenteditable="true">Êñ∞„Åó„ÅÑ„É°„É≥„Éê„Éº</td>
                <td class="part" contenteditable="true">„Éë„Éº„Éà</td>
                <td class="contact" contenteditable="true">ÈÄ£Áµ°ÂÖà</td>
                <td class="actions">
                    <button class="delete-btn" onclick="deleteMember(this)">ÂâäÈô§</button>
                </td>
            `;
            
            tbody.appendChild(newRow);
        }

        function deleteMember(button) {
            if (confirm('„Åì„ÅÆ„É°„É≥„Éê„Éº„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                const row = button.closest('tr');
                row.remove();
                updateMemberNumbers();
            }
        }

        function updateMemberNumbers() {
            const rows = document.querySelectorAll('#memberTableBody tr');
            rows.forEach((row, index) => {
                const numberCell = row.querySelector('.number');
                const numberText = convertToJapaneseNumber(index + 1);
                numberCell.textContent = numberText;
                
                // „É©„Ç∏„Ç™„Éú„Çø„É≥„ÅÆID„Å®value„ÇíÊõ¥Êñ∞
                const radio = row.querySelector('.dash-radio');
                const label = row.querySelector('.dash-label');
                const newId = `dash${index + 1}`;
                radio.id = newId;
                radio.value = index + 1;
                label.setAttribute('for', newId);
            });
            memberCount = rows.length;
        }

        function convertToJapaneseNumber(num) {
            const japaneseNumbers = ['‚ë†', '‚ë°', '‚ë¢', '‚ë£', '‚ë§', '‚ë•', '‚ë¶', '‚ëß', '‚ë®', '‚ë©', '‚ë™', '‚ë´', '‚ë¨', '‚ë≠', '‚ëÆ', '‚ëØ', '‚ë∞', '‚ë±', '‚ë≤', '‚ë≥'];
            return japaneseNumbers[num - 1] || num;
        }

        function createSubmitURL() {
            // ÁèæÂú®„ÅÆ„Éö„Éº„Ç∏„ÅÆ„Éá„Éº„Çø„ÇíÂèéÈõÜ
            const eventName = document.querySelector('.info-item:nth-child(1)').textContent.trim();
            const venue = document.querySelector('.info-item:nth-child(2)').textContent.trim();
            const artistName = document.querySelector('.info-item:nth-child(3)').textContent.trim();
            const memberCount = document.querySelector('.info-item:nth-child(4)').textContent.trim();
            const micCount = document.querySelector('.info-item:nth-child(5)').textContent.trim();
            const date = document.querySelector('.info-item:nth-child(6)').textContent.trim();
            const time = document.querySelector('.info-item:nth-child(7)').textContent.trim();
            
            // „É°„É≥„Éê„Éº„Éá„Éº„Çø„ÇíÂèéÈõÜ
            const membersData = [];
            const rows = document.querySelectorAll('#memberTableBody tr');
            rows.forEach(row => {
                const number = row.querySelector('.number').textContent;
                const name = row.querySelector('.name').textContent;
                const part = row.querySelector('.part').textContent;
                const contact = row.querySelector('.contact').textContent;
                const isRepresentative = row.querySelector('.dash-radio:checked') !== null;
                membersData.push({ number, name, part, contact, isRepresentative });
            });
            
            // „Éá„Éº„Çø„ÇíJSON„Å´Â§âÊèõ
            const submitData = {
                eventName,
                venue,
                artistName,
                memberCount,
                micCount,
                date,
                time,
                members: membersData,
                timestamp: new Date().toISOString()
            };
            
            // Base64„Ç®„É≥„Ç≥„Éº„Éâ
            const jsonString = JSON.stringify(submitData);
            const encodedData = btoa(unescape(encodeURIComponent(jsonString)));
            
            // ÊèêÂá∫Áî®URL„ÇíÁîüÊàê
            const currentURL = window.location.origin + window.location.pathname;
            const submitURL = `${currentURL}?data=${encodedData}`;
            
            // URL„Çí„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº
            navigator.clipboard.writeText(submitURL).then(() => {
                alert('ÊèêÂá∫Áî®URL„Åå„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åï„Çå„Åæ„Åó„ÅüÔºÅ\n\nURL: ' + submitURL);
            }).catch(() => {
                // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: „ÉÜ„Ç≠„Çπ„Éà„Ç®„É™„Ç¢„ÅßË°®Á§∫
                const textArea = document.createElement('textarea');
                textArea.value = submitURL;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('ÊèêÂá∫Áî®URL„Åå„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åï„Çå„Åæ„Åó„ÅüÔºÅ\n\nURL: ' + submitURL);
            });
        }

        function generatePDF() {
            // „Éú„Çø„É≥„Çí‰∏ÄÊôÇÁöÑ„Å´ÈùûË°®Á§∫
            const pdfBtn = document.querySelector('.pdf-btn');
            const submitBtn = document.querySelector('.submit-btn');
            const addBtn = document.querySelector('.add-btn');
            const deleteBtns = document.querySelectorAll('.delete-btn');
            const originalDisplay = pdfBtn.style.display;
            const submitBtnDisplay = submitBtn.style.display;
            const addBtnDisplay = addBtn.style.display;
            const deleteBtnDisplays = Array.from(deleteBtns).map(btn => btn.style.display);
            
            pdfBtn.style.display = 'none';
            submitBtn.style.display = 'none';
            addBtn.style.display = 'none';
            deleteBtns.forEach(btn => btn.style.display = 'none');
            
            // „Ç≥„É≥„ÉÜ„Éä„ÇíÂèñÂæó
            const element = document.querySelector('.container');
            
            // HTML„Çí„Ç≠„É£„É≥„Éê„Çπ„Å´Â§âÊèõ
            html2canvas(element, {
                scale: 2,
                useCORS: true,
                allowTaint: true,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                // „Éú„Çø„É≥„ÇíÂÖÉ„Å´Êàª„Åô
                pdfBtn.style.display = originalDisplay;
                submitBtn.style.display = submitBtnDisplay;
                addBtn.style.display = addBtnDisplay;
                deleteBtns.forEach((btn, index) => {
                    btn.style.display = deleteBtnDisplays[index];
                });
                
                // PDFÁîüÊàê
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // A4„Çµ„Ç§„Ç∫„Å´Âêà„Çè„Åõ„Å¶ÁîªÂÉè„Çí„É™„Çµ„Ç§„Ç∫
                const imgWidth = 210;
                const pageHeight = 295;
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Ë§áÊï∞„Éö„Éº„Ç∏„ÅåÂøÖË¶Å„Å™Â†¥Âêà
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // PDF„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                const eventName = document.querySelector('.info-item:nth-child(1)').textContent.trim();
                const date = document.querySelector('.info-item:nth-child(6)').textContent.trim();
                const fileName = `members_${eventName}_${date}.pdf`.replace(/[^a-zA-Z0-9]/g, '_');
                
                pdf.save(fileName);
            }).catch(error => {
                console.error('PDFÁîüÊàê„Ç®„É©„Éº:', error);
                pdfBtn.style.display = originalDisplay;
                submitBtn.style.display = submitBtnDisplay;
                addBtn.style.display = addBtnDisplay;
                deleteBtns.forEach((btn, index) => {
                    btn.style.display = deleteBtnDisplays[index];
                });
                alert('PDF„ÅÆÁîüÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ');
            });
        }

        // ÊºîÂ•èÊôÇÈñìË®àÁÆóÈñ¢Êï∞
        function calculateTotalTime() {
            // set_list.html„Åã„ÇâÊºîÂ•èÊôÇÈñì„Éá„Éº„Çø„ÇíÂèñÂæó
            const setListData = JSON.parse(localStorage.getItem('setListData') || '[]');
            let totalSeconds = 0;
            
            setListData.forEach(song => {
                const timeText = song.time;
                if (timeText && timeText !== '00:00') {
                    const [minutes, seconds] = timeText.split(':').map(Number);
                    totalSeconds += minutes * 60 + seconds;
                }
            });
            
            const totalMinutes = Math.floor(totalSeconds / 60);
            const remainingSeconds = totalSeconds % 60;
            
            let timeDisplay = '';
            if (totalMinutes > 0) {
                timeDisplay += `${totalMinutes}ÂàÜ`;
            }
            if (remainingSeconds > 0) {
                timeDisplay += `${remainingSeconds}Áßí`;
            }
            
            if (timeDisplay === '') {
                timeDisplay = '0ÂàÜ';
            }
            
            const totalTimeElement = document.getElementById('totalTime');
            if (totalTimeElement) {
                totalTimeElement.textContent = timeDisplay;
            }
        }

        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„Å´ÊºîÂ•èÊôÇÈñì„ÇíË®àÁÆó
        window.addEventListener('load', function() {
            calculateTotalTime();
        });
    </script>
</body>
</html> 